<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="John Doe">





<title>Writeup in 2022CryptoCTF | hash_hash的博客</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        <!-- MathJax配置，可通过单美元符号书写行内公式等 -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- 给MathJax元素添加has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- 通过连接CDN加载MathJax的js代码 -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


    


<meta name="generator" content="Hexo 6.1.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">hash_hash&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/friend">Friends</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">hash_hash&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/friend">Friends</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6;    // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function () {
            tocbot.refresh(obj_merge(tocbot_default_config, { hasInnerContainers: true }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function () {
        tocbot.init(obj_merge(tocbot_default_config, { collapseDepth: 1 }));
    });

    function expandToc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, { collapseDepth: expanded ? 1 : DEPTH_MAX }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">Writeup in 2022CryptoCTF</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">John Doe</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">July 20, 2022&nbsp;&nbsp;21:00:40</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/Writeup/">Writeup</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <blockquote>
<p>It’s my first time to participate CCTF. Finally I got 1218 points and rank 30. During CCTF, I learned some tricks and gained many new view.</p>
<p>I will choose to record some meaningful challenges which I have solved or are still puzzling</p>
<p>BTW , it’s my first time to write solution in English , it can be lame. But it did a opportunity to know terminology.</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/hash-hash/crypto/tree/main/CCTF2022">attachment</a></p>
<h3 id="SOTS"><a href="#SOTS" class="headerlink" title="SOTS"></a>SOTS</h3><p>A classical math problem. Maybe called Sum of Gauss squares. I always use it during the math competition to prove some proposition. But I haven’t thought how to find it. I just search some algorithm named Fermat reduced order method and achieve it.</p>
<img src="/2022/07/20/Writeup-in-2022CryptoCTF/pic1.png" class>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line">n=<span class="number">2076404368738342225663114052301802417814286369156942765753400865872024253</span></span><br><span class="line">p=<span class="number">1872032952276373491266413</span></span><br><span class="line">q=<span class="number">1077425514328313332690477</span></span><br><span class="line">r=<span class="number">1029464059232560561627253</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">facp</span>(<span class="params">p</span>):</span><br><span class="line">    b=<span class="number">1</span></span><br><span class="line">    r=random.randrange(<span class="number">0</span>,p-<span class="number">3</span>)+<span class="number">2</span></span><br><span class="line">    x=(p-<span class="number">1</span>)//<span class="number">4</span></span><br><span class="line">    pm=<span class="built_in">pow</span>(r,x,p)</span><br><span class="line">    <span class="keyword">while</span> pm**<span class="number">2</span>%p!=p-<span class="number">1</span>:</span><br><span class="line">        r=random.randrange(<span class="number">0</span>,p-<span class="number">2</span>)+<span class="number">1</span></span><br><span class="line">        pm=<span class="built_in">pow</span>(r,x,p)</span><br><span class="line">    a=pm</span><br><span class="line">    s=a**<span class="number">2</span>+b**<span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> s!=p:</span><br><span class="line">        M=s//p</span><br><span class="line">        k=M//<span class="number">2</span></span><br><span class="line">        u=a%M</span><br><span class="line">        v=b%M</span><br><span class="line">        <span class="keyword">if</span> u&gt;k:</span><br><span class="line">            u=M-u</span><br><span class="line">        <span class="keyword">if</span> v&gt;k:</span><br><span class="line">            v=M-v</span><br><span class="line">        <span class="keyword">if</span> (u*a+v*b)%M:</span><br><span class="line">            tmp=a</span><br><span class="line">            a=b</span><br><span class="line">            b=tmp</span><br><span class="line">        y=(u*a+v*b)//M</span><br><span class="line">        z=(v*a-u*b)//M</span><br><span class="line">        s=y**<span class="number">2</span>+z**<span class="number">2</span></span><br><span class="line">        a=y</span><br><span class="line">        b=z</span><br><span class="line">    <span class="keyword">return</span> a,b</span><br><span class="line"></span><br><span class="line">a1,b1=facp(p)</span><br><span class="line">a2,b2=facp(q)</span><br><span class="line">a3,b3=facp(r)</span><br><span class="line">uu=(a1*a2+b1*b2)</span><br><span class="line">vv=(a1*b2-b1*a2)</span><br><span class="line">u=uu*a3+vv*b3</span><br><span class="line">v=uu*b3-vv*a3</span><br><span class="line"><span class="built_in">print</span>(u)</span><br><span class="line"><span class="built_in">print</span>(v)</span><br></pre></td></tr></table></figure>

<p>sagemath have relevant function to solve it</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">1872032952276373491266413</span></span><br><span class="line"><span class="built_in">print</span>(two_squares(p))</span><br></pre></td></tr></table></figure>

<p>A higher point is factor n in $Z[i]$, I try it in sage but fail</p>
<h3 id="Diploma"><a href="#Diploma" class="headerlink" title="Diploma"></a>Diploma</h3><p>A problem about GL(n)’s order. I’ve seen this problem before. In a papper I get answer $ord|∏^{n−1}_{i&#x3D;0}(p^n−p^i)$. But sage still have relative func <code>M.multiplicative_order()</code></p>
<p>The interaction is painful</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&#x27;08.cr.yp.toc.tf&#x27;</span>,<span class="number">37313</span>)</span><br><span class="line">p=<span class="number">127</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"> io.recvuntil(<span class="string">&#x27;M = \n&#x27;</span>)</span><br><span class="line"> M=[]</span><br><span class="line"> <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  tmp=<span class="string">&#x27;&#x27;</span></span><br><span class="line">  re=io.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">if</span> <span class="string">b&#x27;matrix M:&#x27;</span> <span class="keyword">in</span> re:</span><br><span class="line">   <span class="keyword">break</span></span><br><span class="line">  tmp+=<span class="built_in">chr</span>(re[<span class="number">0</span>])</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(re)):</span><br><span class="line">   <span class="keyword">if</span> i&gt;<span class="number">2</span> <span class="keyword">and</span> re[i]==<span class="number">32</span>:</span><br><span class="line">    <span class="keyword">if</span> tmp[<span class="built_in">len</span>(tmp)-<span class="number">1</span>]!=<span class="string">&#x27;,&#x27;</span> <span class="keyword">and</span> tmp[<span class="built_in">len</span>(tmp)-<span class="number">1</span>]!=<span class="string">&#x27;]&#x27;</span>:</span><br><span class="line">     tmp+=<span class="string">&#x27;,&#x27;</span></span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">    tmp+=<span class="built_in">chr</span>(re[i]) </span><br><span class="line">  <span class="built_in">print</span>(tmp)</span><br><span class="line">  M.append(<span class="built_in">eval</span>(tmp))</span><br><span class="line"> M=Matrix(GF(p),M)</span><br><span class="line"> order=M.multiplicative_order()</span><br><span class="line"> io.sendline(<span class="built_in">str</span>(order))</span><br></pre></td></tr></table></figure>

<h3 id="Starter-ECC"><a href="#Starter-ECC" class="headerlink" title="Starter ECC"></a>Starter ECC</h3><p>this challenge is to solve $f(x)&#x3D;0~GF(p^t)$ with $deg(f)&#x3D;2$</p>
<p>I solve it using the same idea in SEECTF(DLP) just like a lifting theorem</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover2</span>(<span class="params">t,w</span>):</span><br><span class="line">    cofs=[]</span><br><span class="line">    PR.&lt;x&gt;=PolynomialRing(Zmod(<span class="number">2</span>))</span><br><span class="line">    f=x^<span class="number">2</span>-t</span><br><span class="line">    root=f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    cofs.append(<span class="built_in">int</span>(root))</span><br><span class="line">    tmp=<span class="built_in">int</span>(root)</span><br><span class="line">    cofs.append(<span class="number">1</span>)</span><br><span class="line">    tmp+=<span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>,w+<span class="number">1</span>):</span><br><span class="line">        cof=((t-tmp^<span class="number">2</span>)*gmpy2.invert(tmp,<span class="number">2</span>^i)%<span class="number">2</span>^i)//<span class="number">2</span>^(i-<span class="number">1</span>)</span><br><span class="line">        cofs.append(cof)</span><br><span class="line">        tmp+=cof*<span class="number">2</span>^(i-<span class="number">2</span>)</span><br><span class="line">    cofs.append(<span class="number">1</span>)</span><br><span class="line">    re=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">        re+=cofs[i]*<span class="number">2</span>^i</span><br><span class="line">    <span class="keyword">return</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover</span>(<span class="params">t,p,w,i</span>):</span><br><span class="line">    cofs=[]</span><br><span class="line">    PR.&lt;x&gt;=PolynomialRing(Zmod(p))</span><br><span class="line">    f=x^<span class="number">2</span>-t</span><br><span class="line">    root=f.roots()[i][<span class="number">0</span>]</span><br><span class="line">    cofs.append(<span class="built_in">int</span>(root))</span><br><span class="line">    tmp=<span class="built_in">int</span>(root)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,w+<span class="number">1</span>):</span><br><span class="line">        cof=((t-tmp^<span class="number">2</span>)*gmpy2.invert(<span class="number">2</span>*tmp,p^i)%p^i)//p^(i-<span class="number">1</span>)</span><br><span class="line">        cofs.append(cof)</span><br><span class="line">        tmp+=cof*p^(i-<span class="number">1</span>)</span><br><span class="line">    re=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">        re+=cofs[i]*p^i</span><br><span class="line">    <span class="keyword">return</span> re</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">xx = <span class="number">10715086071862673209484250490600018105614048117055336074437503883703510511249361224931983788156958581275946729175531468251871452856923140435984577574698574803934567774824230985421074605062371141877954182153046477020617917601884853827611232355455223966039590143622792803800879186033924150173912925208583</span></span><br><span class="line">a = <span class="number">31337</span></span><br><span class="line">b = <span class="number">66826418568487077181425396984743905464189470072466833884636947306507380342362386488703702812673327367379386970252278963682939080502468506452884260534949120967338532068983307061363686987539408216644249718950365322078643067666802845720939111758309026343239779555536517718292754561631504560989926785152983649035</span></span><br><span class="line">p1=<span class="number">2</span></span><br><span class="line">p2=<span class="number">690712633549859897233</span></span><br><span class="line">p3= <span class="number">651132262883189171676209466993073</span></span><br><span class="line">n=<span class="number">117224988229627436482659673624324558461989737163733991529810987781450160688540001366778824245275287757373389887319739241684244545745583212512813949172078079042775825145312900017512660931667853567060810331541927568102860039898116182248597291899498790518105909390331098630690977858767670061026931938152924839936</span></span><br><span class="line">t=(xx^<span class="number">3</span>+a*xx+b)%n</span><br><span class="line">y1=recover2(t,<span class="number">63</span>)</span><br><span class="line">y2=recover(t,p2,<span class="number">6</span>,<span class="number">1</span>)</span><br><span class="line">y3=recover(t,p3,<span class="number">5</span>,<span class="number">1</span>)</span><br><span class="line">m=crt([y1,y2,y3],[p1^<span class="number">63</span>,p2^<span class="number">6</span>,p3^<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<p>another way is to use p-adic. It’s easy beacause sage have some module. But I don’t know much about it.</p>
<p>can use it like this</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">t=<span class="number">93537210270650150510202879113948342209471088325309071397356033881709266017880457869963986668043867063176965473274592196316442</span></span><br><span class="line">p=<span class="number">690712633549859897233</span></span><br><span class="line">s=ZZ(Qp(p)(t).sqrt())%p^<span class="number">6</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">pow</span>(s,<span class="number">2</span>,p^<span class="number">6</span>)==t</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>

<h3 id="Oak-Land"><a href="#Oak-Land" class="headerlink" title="Oak Land"></a>Oak Land</h3><p>A interesting challenge. I do it but fail to observe the special data.</p>
<p>It looks like multiple element dlp, but you can simply it by build connection between variable. Finally it’s just need solve a low degree equation.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">7389313481223384214994762619823300589978423075857540712007981373887018860174846208000957230283669342186460652521580595183523706412588695116906905718440770776239313669678685198683933547601793742596023475603667</span></span><br><span class="line">e = <span class="number">31337</span></span><br><span class="line">f = <span class="number">7236042467316654159796543399639966340258093274047941788600980451877044636122969830708918356119442228154447395855689559447196348683125675305629837437591088260218138895919514078948650757100432223219969122629790</span></span><br><span class="line">g = <span class="number">1878626136321051642174045874618248475160620873585704351202865003185878331837410979441756843820270907300810543618813757245154196050399357659526631164136221434463496532263979506870318259276669412698827040743576</span></span><br><span class="line">c=<span class="number">871346503375040565701864845493751233877009611275883500035764036792906970084258238763963152627486758242101207127598485219754255161617890137664012548226251138485059295263306930653899766537171223837761341914356</span></span><br><span class="line">Fp=GF(p)</span><br><span class="line">e=Fp(e)</span><br><span class="line">f=Fp(f)</span><br><span class="line">g=Fp(g)</span><br><span class="line">t1=<span class="built_in">int</span>(f.log(e))</span><br><span class="line">t2=<span class="built_in">int</span>(g.log(e))</span><br><span class="line"><span class="comment">#print(p)</span></span><br><span class="line"><span class="comment">#print(t1)</span></span><br><span class="line"><span class="comment">#print(t2)</span></span><br><span class="line">PR.&lt;x&gt;=PolynomialRing(Zmod(p))</span><br><span class="line">f=<span class="number">110</span>*x^<span class="number">3</span>-c*x^<span class="number">2</span>+<span class="number">313</span>*x+<span class="number">114</span></span><br><span class="line">cc=f.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">cc=Fp(cc)</span><br><span class="line">m=cc.log(e)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(<span class="built_in">int</span>(m))[<span class="number">2</span>:]))</span><br></pre></td></tr></table></figure>

<h3 id="Infinity-Castle"><a href="#Infinity-Castle" class="headerlink" title="Infinity Castle"></a>Infinity Castle</h3><p>diamond(n) is $n^2$, triage(n) is $n^3$, TaylorSeries is the Taylor expansion of the square root of x</p>
<p>You can emtimate summarize’s result by integral. Because we don’t need exact value of key. So do it by estimating is feasible</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">cip, key</span>):</span><br><span class="line">    repeation = <span class="number">1</span> + (<span class="built_in">len</span>(cip) // <span class="built_in">len</span>(key))</span><br><span class="line">    key = key * repeation</span><br><span class="line">    key = key[:<span class="built_in">len</span>(cip)]</span><br><span class="line"></span><br><span class="line">    msg = <span class="built_in">bytes</span>([c ^ k <span class="keyword">for</span> c, k <span class="keyword">in</span> <span class="built_in">zip</span>(cip, key)])</span><br><span class="line">    <span class="keyword">return</span> msg</span><br><span class="line"></span><br><span class="line">c0 = <span class="number">194487778980461745865921475300460852453586088781074246328543689440168930873549359227127363759885970436167330043371627413542337857082400024590112412164095470165662281502211335756288082198009158469871465280749846525326701136380764079685636158337203211609233704905784093776008350120607841177268965738426317288541638374141671346404729428158104872411498098187946543666987926130124245185069569476433120128275581891425551325847219504501925282012199947834686225770246801353666030075146469275695499044424390475398423700504158154044180028733800154044746648133536737830623670383925046006108348861714435567006327619892239876863209887013290251890513192375749866675256952802329688897844132157098061758362137357387787072005860610663777569670198971946904157425377235056152628515775755249828721767845990597859165193162537676147173896835503209596955703313430433124688537275895468076469102220355973904702901083642275544954262724054693167603475188412046722656788470695566949847884250306735314144182029335732280420629131990311054229665691517003924788583771265625694414774865289407885678238795596912006567817508035434074250123869676396153982762032750080222602796273083162627489526255501643913672882350236497429678928099868244687228703074267962827621792960</span></span><br><span class="line">c1 = <span class="number">102325064080381160170299055162846304227217463467232681115953623386548494169967745781550171804781503102663445039561476870208178139548389771866145006535051362059443515034504958703659546162037904784821960707630188600064568878674788077706711506213779443920430038560373854184526850365974450688458342413544179732143225845085164110594063440979455274250021370090572731855665413325275414458572412561502408983107820534723804225765540316307539962199024757378469001612921489902325166003841336027940632451584642359132723894801946906069322200784708303615779699081247051006259449466759863245508473429631466831174013498995506423210088549372249221415401309493511477847517923201080509933268996867995533386571564898914042844521373220497356837599443280354679778455765441375957556266205953496871475611269965949025704864246188576674107448587696941054123618319505271195780178776338475090463487960063464172195337956577785477587755181298859587398321270677790915227557908728226236404532915215698698185501562405374498053670694387354757252731874312411228777004316623425843477845333936913444143768519959591070492639650368662529749434618783626718975406802741753688956961837855306815380844030665696781685152837849982159679122660714556706669865596780528277684800454866433826417980212164051043504955615794706595412705883261111953152250227679858538249797999044336210905975316421254442221408945203647754303635775048438188044803368249944201671941949138202928389951227347433255867504906597772044398973241425387514239164853656233776024571606159378910745571588836981735827902305330330946219857271646498602227088657739442867033212012876837654750348578740516798444734534291467314881324902354425889448102902750077077381896216130734894767553834949561471219923459897244690006643798812989271282475503126962274052192342840870308710338336817452628324667507548265612892611100350882163205858101959976</span></span><br><span class="line">enc = <span class="number">122235247669762131006183252122503937958296387791525458429403709404875223067116491817728568224832483391622109986550732469556761300197133827976956875865159629512476600711420561872409721582387803219651736262581445978042694384374119142613277808898398213602093802571586386354257378956087240174787723503606671543195193114158641301908622673736098768829071270132073818245595918660134745516367731595853832524328488074054536278197115937409643221809577554866060292157239061557708159310445977052686561229611117673473208278176118561352693319461471419694590218295911647368543698198762827636021268989705079848502749837879584394379300566277359149621932579222865430374652678738198451655509408564586496375811666876030847654260305392984710580761255795785508407844683687773983669843744274915862335181251050775093896006210092665809300090715190088851654138383362259256212093670748527819287681468901379286722214112321906917311154811516336259463356911326393701445497605365038857575515541024824906818473933597129846235905072394148879079996812146836910199111439031562946495046766063326815863624262541346543552652673629442370320109404700346028639853707278295255350982238521659924641921142615894039995513480511108116053798143154593343124822462519555715118822045</span></span><br><span class="line">s1=gmpy2.iroot(c1,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">s2=gmpy2.iroot(c0**<span class="number">3</span>//c1,<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">p=(s1+s2)//<span class="number">2</span></span><br><span class="line">q=(s1-s2)//<span class="number">2</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line">d=inverse(e,phi)</span><br><span class="line">key=long_to_bytes(<span class="built_in">int</span>(<span class="number">2</span>*isqrt(<span class="built_in">pow</span>(n,<span class="number">3</span>))//<span class="number">3</span>))</span><br><span class="line">c=long_to_bytes(<span class="built_in">pow</span>(enc,d,n))</span><br><span class="line"><span class="built_in">print</span>(xor(c,key))</span><br></pre></td></tr></table></figure>

<h3 id="Resign"><a href="#Resign" class="headerlink" title="Resign"></a>Resign</h3><p>I didn’t finish it on time because lack the proper Smooth number. However I find this problem can be solved by reduce the smooth level.(Cyclic groups have higher orders)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_primes</span>(<span class="params">nbit, imbalance</span>):</span><br><span class="line">	p = <span class="number">2</span></span><br><span class="line">	FACTORS = [p]</span><br><span class="line">	<span class="keyword">while</span> p.bit_length() &lt; nbit - <span class="number">2</span> * imbalance:</span><br><span class="line">		factor = getPrime(imbalance)</span><br><span class="line">		FACTORS.append(factor)</span><br><span class="line">		p *= factor</span><br><span class="line">	rbit = (nbit - p.bit_length()) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		r, s = [getPrime(rbit) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&#x27;01&#x27;</span>]</span><br><span class="line">		_p = p * r * s</span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &lt; nbit: rbit += <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> _p.bit_length() &gt; nbit: rbit -= <span class="number">1</span></span><br><span class="line">		<span class="keyword">if</span> isPrime(_p + <span class="number">1</span>):</span><br><span class="line">			FACTORS.extend((r, s))</span><br><span class="line">			p = _p + <span class="number">1</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">	FACTORS.sort()</span><br><span class="line">	<span class="keyword">return</span> (p, FACTORS)</span><br><span class="line"></span><br><span class="line">p,_=gen_primes(<span class="number">1024</span>,<span class="number">20</span>)</span><br><span class="line">q,_=gen_primes(<span class="number">1024</span>,<span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p=&#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;q=&#x27;</span>,q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">s=<span class="number">7984117781193502575412750505430979186228119017807317960994355227205949819092428731236337909197167584395143960813661416647917034357707829764233170814875745583208603309833382309448961632449932606644599794982667065067211545658432155270344026432978482493058391281970539985258874195736716168226015296465896222711449764960924598244484042742120206434449431821943587424974496744540622137023049971061842575042202489321438759754822828568020390315315068482818064779065128579172903182839413115643905215071190495277703316420230587526327805179182224313125252287971253632106014646086776569402554056131078566070017884013630764049336</span></span><br><span class="line">h=<span class="number">859134015240994359820678247621894875833976723365</span></span><br><span class="line">p= <span class="number">122415509565518531443147639848448248409469589947486005320386529550844357405484773578332786457733733732418287234961042780614741190123679692506761189624673309052253155681404430445151991408962587788043621396541174258856184502345401381866169756836931056269731266097189703314853514497934474702757788612726278471587</span></span><br><span class="line">q= <span class="number">76506675455644608060963110138362743927973612279961964190480978401417336483425872394063064854906790750016782282678362690623938928815788994891134844315959485830145364283392280519872728172078240496191944338394829808009536643696258457554553352482738348872308968685891720161748887997488378363675678238379325906643</span></span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">fp=GF(p)</span><br><span class="line">fq=GF(q)</span><br><span class="line">d1=discrete_log(s,fp(h))</span><br><span class="line">d2=discrete_log(s,fq(h))</span><br><span class="line">e=crt([d1,d2],[p-<span class="number">1</span>,q-<span class="number">1</span>])</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br></pre></td></tr></table></figure>

<h3 id="Faonsa-amp-Fiercest"><a href="#Faonsa-amp-Fiercest" class="headerlink" title="Faonsa&amp;Fiercest"></a>Faonsa&amp;Fiercest</h3><p>Both of two question have same thought. We need make the modulu smooth using <a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/167018">fault attack</a>(just a name but interesting)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">98946348531671552366599636519893607646703047155335246624251536405323524152537202603241932094835105000412311403806982008184571354393081819367329019220712532243268590378962545968974721430598690895928222554884889004911627379371908932211309804472944234919739986668246269664956128234005360667329571534551093537337</span></span><br><span class="line">MSG = <span class="string">&quot;4lL crypt0sy5t3ms suck5 fr0m faul7 atTaCk5 :P&quot;</span></span><br><span class="line">m = bytes_to_long(MSG.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(<span class="built_in">bin</span>(n)[<span class="number">2</span>:])):</span><br><span class="line">    tmp=n^(<span class="number">2</span>**(<span class="built_in">len</span>(<span class="built_in">bin</span>(n)[<span class="number">2</span>:])-i))</span><br><span class="line">    <span class="keyword">if</span> isPrime(tmp):</span><br><span class="line">        <span class="built_in">print</span>(i-<span class="number">1</span>)</span><br><span class="line">        p=tmp</span><br><span class="line">        phi=p-<span class="number">1</span></span><br><span class="line">        d=inverse(e,phi)</span><br><span class="line">        sign=<span class="built_in">pow</span>(m,d,tmp)</span><br><span class="line">        <span class="built_in">print</span>(sign)</span><br><span class="line">        se=<span class="built_in">pow</span>(sign,e,p)-m</span><br><span class="line">        <span class="built_in">print</span>(se)</span><br></pre></td></tr></table></figure>

<p>But these two question all have a same bug, called shallow copy. It’s really interesting. By it,we can make modulu be whatever we want.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a=[1,2,3]</span><br><span class="line">b=a</span><br><span class="line">print(a)</span><br><span class="line">b[0]=7</span><br><span class="line">print(a)</span><br><span class="line">#[1, 2, 3]</span><br><span class="line">#[7, 2, 3]</span><br></pre></td></tr></table></figure>

<h3 id="Mino"><a href="#Mino" class="headerlink" title="Mino"></a>Mino</h3><p>I did’t finish it. I see someone do it by recursion. It’s perfect but a little hard. Rencently, I see some new solution-$z_3$ and it’s fast.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">n=<span class="number">40</span></span><br><span class="line">V=[z3.BitVec(<span class="string">&quot;V&#123;&#125;&quot;</span>.<span class="built_in">format</span>(i),<span class="number">42</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">con1=[z3.And(<span class="number">1</span>&lt;=V[i],V[i]&lt;=n) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">con2=[z3.Distinct(V)]</span><br><span class="line">con3=[<span class="built_in">sum</span>(V[i]*(-<span class="number">2</span>)**i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))==<span class="number">0</span>]</span><br><span class="line">sol=Solver()</span><br><span class="line">sol.add(con1+con2+con3)</span><br><span class="line"><span class="built_in">print</span>(sol.check())</span><br><span class="line"><span class="built_in">print</span>(sol.model())</span><br></pre></td></tr></table></figure>

<h3 id="Side-step"><a href="#Side-step" class="headerlink" title="Side step"></a>Side step</h3><p>All it takes is a simple idea, use $2^2&#x3D;4$ to check s bit by bit</p>
<p>function pow_d’s process will calculate pow(g,bin(s)[:i],p) for any i. So we can use g&#x3D;pow(2,-bin(s)[:i],p) to check whether the $(i+1)^{th}$ bit of s is equal to 1. </p>
<p>The script may needs to be run multiple times to make sure s is 1023 bits</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">io=remote(<span class="string">&#x27;01.cr.yp.toc.tf&#x27;</span>,<span class="number">17331</span>)</span><br><span class="line"><span class="comment">#io=process(&#x27;./side.py&#x27;)</span></span><br><span class="line">p = <span class="number">2</span> ** <span class="number">1024</span> - <span class="number">2</span> ** <span class="number">234</span> - <span class="number">2</span> ** <span class="number">267</span> - <span class="number">2</span> ** <span class="number">291</span> - <span class="number">2</span> ** <span class="number">403</span> - <span class="number">1</span></span><br><span class="line">s=<span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ts</span>(<span class="params">m, p</span>):</span><br><span class="line"> m = m % p</span><br><span class="line"> <span class="keyword">return</span> <span class="built_in">pow</span>(m, (p - <span class="number">1</span>) // <span class="number">2</span>, p) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>():</span><br><span class="line"> <span class="keyword">global</span> s</span><br><span class="line"> io.sendlineafter(<span class="string">&#x27;[Q]uit\n&#x27;</span>,<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line"> e=<span class="built_in">int</span>(s,<span class="number">2</span>)</span><br><span class="line"> d=gmpy2.invert(e,(p-<span class="number">1</span>)//<span class="number">2</span>)</span><br><span class="line"> g=<span class="built_in">pow</span>(<span class="number">2</span>,d,p)</span><br><span class="line"> io.sendline(<span class="built_in">str</span>(g))</span><br><span class="line"> io.recvuntil(<span class="string">&#x27;t, r = (&#x27;</span>)</span><br><span class="line"> sign=<span class="built_in">int</span>(io.recvuntil(<span class="string">&#x27;,&#x27;</span>)[:-<span class="number">1</span>])</span><br><span class="line"> <span class="keyword">if</span> sign==<span class="number">0</span>:</span><br><span class="line">  s+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line"> <span class="keyword">else</span>:</span><br><span class="line">  s+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1022</span>)):</span><br><span class="line"> search()</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">s=<span class="built_in">int</span>(s,<span class="number">2</span>)</span><br><span class="line">dd=inverse(s,(p-<span class="number">1</span>)//<span class="number">2</span>)</span><br><span class="line">m=<span class="built_in">pow</span>(<span class="number">4</span>,dd,p)</span><br><span class="line">io.sendlineafter(<span class="string">&#x27;[Q]uit\n&#x27;</span>,<span class="string">&#x27;t&#x27;</span>)</span><br><span class="line">sleep(<span class="number">0.01</span>)</span><br><span class="line">io.sendline(<span class="built_in">str</span>(m))</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>John Doe</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="https://hash-hash.github.io/2022/07/20/Writeup-in-2022CryptoCTF/">https://hash-hash.github.io/2022/07/20/Writeup-in-2022CryptoCTF/</a></span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>License:</span>
                        <span>Copyright (c) 2019 <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/">CC-BY-NC-4.0</a> LICENSE</span>
                    </p>
                
                
                     <p class="copyright-item">
                         <span>Slogan:</span>
                         <span>Do you believe in <strong>DESTINY</strong>?</span>
                     </p>
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/wp/"># wp</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2022/07/11/Information-Theory-and-Coding-Theory/">Information Theory and Coding Theory</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© John Doe | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>